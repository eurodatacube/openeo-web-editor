(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b63012a2","chunk-b63012a2","chunk-b63012a2","chunk-b63012a2"],{"30d1":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return f}));var i=r("869f"),n=r("1300"),a=.5,s={Point:m,LineString:g,Polygon:b,MultiPoint:y,MultiLineString:_,MultiPolygon:v,GeometryCollection:p,Circle:c};function o(e,t){return parseInt(Object(n["c"])(e),10)-parseInt(Object(n["c"])(t),10)}function h(e,t){var r=u(e,t);return r*r}function u(e,t){return a*e/t}function c(e,t,r,i,n){var a=r.getFill(),s=r.getStroke();if(a||s){var o=e.getBuilder(r.getZIndex(),"Circle");o.setFillStrokeStyle(a,s),o.drawCircle(t,i)}var h=r.getText();if(h&&h.getText()){var u=(n||e).getBuilder(r.getZIndex(),"Text");u.setTextStyle(h),u.drawText(t,i)}}function f(e,t,r,n,a,s,o){var h=!1,u=r.getImage();if(u){var c=u.getImageState();c==i["a"].LOADED||c==i["a"].ERROR?u.unlistenImageChange(a):(c==i["a"].IDLE&&u.load(),u.listenImageChange(a),h=!0)}return l(e,t,r,n,s,o),h}function l(e,t,r,i,n,a){var o=r.getGeometryFunction()(t);if(o){var h=o.simplifyTransformed(i,n),u=r.getRenderer();if(u)d(e,h,r,t);else{var c=s[h.getType()];c(e,h,r,t,a)}}}function d(e,t,r,i){if("GeometryCollection"!=t.getType()){var n=e.getBuilder(r.getZIndex(),"Default");n.drawCustom(t,i,r.getRenderer(),r.getHitDetectionRenderer())}else for(var a=t.getGeometries(),s=0,o=a.length;s<o;++s)d(e,a[s],r,i)}function p(e,t,r,i,n){var a,o,h=t.getGeometriesArray();for(a=0,o=h.length;a<o;++a){var u=s[h[a].getType()];u(e,h[a],r,i,n)}}function g(e,t,r,i,n){var a=r.getStroke();if(a){var s=e.getBuilder(r.getZIndex(),"LineString");s.setFillStrokeStyle(null,a),s.drawLineString(t,i)}var o=r.getText();if(o&&o.getText()){var h=(n||e).getBuilder(r.getZIndex(),"Text");h.setTextStyle(o),h.drawText(t,i)}}function _(e,t,r,i,n){var a=r.getStroke();if(a){var s=e.getBuilder(r.getZIndex(),"LineString");s.setFillStrokeStyle(null,a),s.drawMultiLineString(t,i)}var o=r.getText();if(o&&o.getText()){var h=(n||e).getBuilder(r.getZIndex(),"Text");h.setTextStyle(o),h.drawText(t,i)}}function v(e,t,r,i,n){var a=r.getFill(),s=r.getStroke();if(s||a){var o=e.getBuilder(r.getZIndex(),"Polygon");o.setFillStrokeStyle(a,s),o.drawMultiPolygon(t,i)}var h=r.getText();if(h&&h.getText()){var u=(n||e).getBuilder(r.getZIndex(),"Text");u.setTextStyle(h),u.drawText(t,i)}}function m(e,t,r,n,a){var s,o=r.getImage(),h=r.getText();if(o){if(o.getImageState()!=i["a"].LOADED)return;var u=e;if(a){var c=o.getDeclutterMode();if("none"!==c)if(u=a,"obstacle"===c){var f=e.getBuilder(r.getZIndex(),"Image");f.setImageStyle(o,s),f.drawPoint(t,n)}else h&&h.getText()&&(s={})}var l=u.getBuilder(r.getZIndex(),"Image");l.setImageStyle(o,s),l.drawPoint(t,n)}if(h&&h.getText()){var d=e;a&&(d=a);var p=d.getBuilder(r.getZIndex(),"Text");p.setTextStyle(h,s),p.drawText(t,n)}}function y(e,t,r,n,a){var s,o=r.getImage(),h=r.getText();if(o){if(o.getImageState()!=i["a"].LOADED)return;var u=e;if(a){var c=o.getDeclutterMode();if("none"!==c)if(u=a,"obstacle"===c){var f=e.getBuilder(r.getZIndex(),"Image");f.setImageStyle(o,s),f.drawMultiPoint(t,n)}else h&&h.getText()&&(s={})}var l=u.getBuilder(r.getZIndex(),"Image");l.setImageStyle(o,s),l.drawMultiPoint(t,n)}if(h&&h.getText()){var d=e;a&&(d=a);var p=d.getBuilder(r.getZIndex(),"Text");p.setTextStyle(h,s),p.drawText(t,n)}}function b(e,t,r,i,n){var a=r.getFill(),s=r.getStroke();if(a||s){var o=e.getBuilder(r.getZIndex(),"Polygon");o.setFillStrokeStyle(a,s),o.drawPolygon(t,i)}var h=r.getText();if(h&&h.getText()){var u=(n||e).getBuilder(r.getZIndex(),"Text");u.setTextStyle(h),u.drawText(t,i)}}},ac3a:function(e,t,r){"use strict";var i=r("ae50"),n=r("a43f"),a=r("496f"),s=r("aab2"),o=r("df4c"),h=r("faf4"),u=r("3333"),c=r("070d"),f=r("5e7e"),l=r("a896"),d=r("0af5"),p=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),g={GENERATE_BUFFERS:"GENERATE_BUFFERS"},_=function(e){function t(t,r){var i=e.call(this,t)||this,n=r||{};return i.inversePixelTransform_=Object(l["c"])(),i.pixelContext_=null,i.postProcesses_=n.postProcesses,i.uniforms_=n.uniforms,i.helper,t.addChangeListener(o["a"].MAP,i.removeHelper.bind(i)),i.dispatchPreComposeEvent=i.dispatchPreComposeEvent.bind(i),i.dispatchPostComposeEvent=i.dispatchPostComposeEvent.bind(i),i}return p(t,e),t.prototype.dispatchPreComposeEvent=function(e,t){var r=this.getLayer();if(r.hasListener(c["a"].PRECOMPOSE)){var i=new u["a"](c["a"].PRECOMPOSE,void 0,t,e);r.dispatchEvent(i)}},t.prototype.dispatchPostComposeEvent=function(e,t){var r=this.getLayer();if(r.hasListener(c["a"].POSTCOMPOSE)){var i=new u["a"](c["a"].POSTCOMPOSE,void 0,t,e);r.dispatchEvent(i)}},t.prototype.reset=function(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)},t.prototype.removeHelper=function(){this.helper&&(this.helper.dispose(),delete this.helper)},t.prototype.prepareFrame=function(e){if(this.getLayer().getRenderSource()){for(var r=!0,i=-1,n=void 0,a=0,s=e.layerStatesArray.length;a<s;a++){var o=e.layerStatesArray[a].layer,h=o.getRenderer();if(h instanceof t){var u=o.getClassName();if((r||u!==n)&&(i+=1,r=!1),n=u,h===this)break}else r=!0}var c="map/"+e.mapId+"/group/"+i;this.helper&&this.helper.canvasCacheKeyMatches(c)||(this.removeHelper(),this.helper=new f["c"]({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:c}),n&&(this.helper.getCanvas().className=n),this.afterHelperCreated())}return this.prepareFrameInternal(e)},t.prototype.afterHelperCreated=function(){},t.prototype.prepareFrameInternal=function(e){return!0},t.prototype.disposeInternal=function(){this.removeHelper(),e.prototype.disposeInternal.call(this)},t.prototype.dispatchRenderEvent_=function(e,t,r){var i=this.getLayer();if(i.hasListener(e)){Object(l["b"])(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);var n=new u["a"](e,this.inversePixelTransform_,r,t);i.dispatchEvent(n)}},t.prototype.preRender=function(e,t){this.dispatchRenderEvent_(c["a"].PRERENDER,e,t)},t.prototype.postRender=function(e,t){this.dispatchRenderEvent_(c["a"].POSTRENDER,e,t)},t.prototype.getDataAtPixel=function(e,t,r){var i=Object(l["a"])([t.pixelRatio,0,0,t.pixelRatio,0,0],e.slice()),n=this.helper.getGL();if(!n)return null;var a=this.getLayer(),s=a.getExtent();if(s){var o=Object(l["a"])(t.pixelToCoordinateTransform,e.slice());if(!Object(d["f"])(s,o))return null}var h=n.getContextAttributes();if(!h||!h.preserveDrawingBuffer)return new Uint8Array;var u,c=Math.round(i[0]),f=Math.round(i[1]),p=this.pixelContext_;if(!p){var g=document.createElement("canvas");g.width=1,g.height=1,p=g.getContext("2d"),this.pixelContext_=p}p.clearRect(0,0,1,1);try{p.drawImage(n.canvas,c,f,1,1,0,0,1,1),u=p.getImageData(0,0,1,1).data}catch(_){return u}return 0===u[3]?null:u},t}(h["a"]);function v(e,t){var r=t||[],i=256,n=i-1;return r[0]=Math.floor(e/i/i/i)/n,r[1]=Math.floor(e/i/i)%i/n,r[2]=Math.floor(e/i)%i/n,r[3]=e%i/n,r}function m(e){var t=0,r=256,i=r-1;return t+=Math.round(e[0]*r*r*r*i),t+=Math.round(e[1]*r*r*i),t+=Math.round(e[2]*r*i),t+=Math.round(e[3]*i),t}var y=_,b=r("d706"),T=r("86e0"),x=r("92fa"),E=r("7fd1"),I=r("1300"),R=r("1e8d"),S=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),O=function(e){function t(t,r){var i=this,a=r.uniforms||{},o=Object(l["c"])();a[f["b"].PROJECTION_MATRIX]=o,i=e.call(this,t,{uniforms:a,postProcesses:r.postProcesses})||this,i.ready=!1,i.sourceRevision_=-1,i.verticesBuffer_=new s["a"](T["a"],T["b"]),i.hitVerticesBuffer_=new s["a"](T["a"],T["b"]),i.indicesBuffer_=new s["a"](T["c"],T["b"]),i.vertexShader_=r.vertexShader,i.fragmentShader_=r.fragmentShader,i.program_,i.hitDetectionEnabled_=!(!r.hitFragmentShader||!r.hitVertexShader),i.hitVertexShader_=r.hitVertexShader,i.hitFragmentShader_=r.hitFragmentShader,i.hitProgram_;var h=r.attributes?r.attributes.map((function(e){return{name:"a_"+e.name,size:1,type:f["a"].FLOAT}})):[];i.attributes=[{name:"a_position",size:2,type:f["a"].FLOAT},{name:"a_index",size:1,type:f["a"].FLOAT}].concat(h),i.hitDetectionAttributes=[{name:"a_position",size:2,type:f["a"].FLOAT},{name:"a_index",size:1,type:f["a"].FLOAT},{name:"a_hitColor",size:4,type:f["a"].FLOAT},{name:"a_featureUid",size:1,type:f["a"].FLOAT}].concat(h),i.customAttributes=r.attributes?r.attributes:[],i.previousExtent_=Object(d["j"])(),i.currentTransform_=o,i.renderTransform_=Object(l["c"])(),i.invertRenderTransform_=Object(l["c"])(),i.renderInstructions_=new Float32Array(0),i.hitRenderInstructions_=new Float32Array(0),i.hitRenderTarget_,i.generateBuffersRun_=0,i.worker_=Object(E["a"])(),i.worker_.addEventListener("message",function(e){var t=e.data;if(t.type===g.GENERATE_BUFFERS){var r=t.projectionTransform;t.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(t.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=r,Object(l["d"])(this.invertRenderTransform_,this.renderTransform_),t.hitDetection?this.hitRenderInstructions_=new Float32Array(e.data.renderInstructions):(this.renderInstructions_=new Float32Array(e.data.renderInstructions),t.generateBuffersRun===this.generateBuffersRun_&&(this.ready=!0)),this.getLayer().changed()}}.bind(i)),i.featureCache_={},i.featureCount_=0;var u=i.getLayer().getSource();return i.sourceListenKeys_=[Object(R["a"])(u,n["a"].ADDFEATURE,i.handleSourceFeatureAdded_,i),Object(R["a"])(u,n["a"].CHANGEFEATURE,i.handleSourceFeatureChanged_,i),Object(R["a"])(u,n["a"].REMOVEFEATURE,i.handleSourceFeatureDelete_,i),Object(R["a"])(u,n["a"].CLEAR,i.handleSourceFeatureClear_,i)],u.forEachFeature(function(e){this.featureCache_[Object(I["c"])(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}.bind(i)),i}return S(t,e),t.prototype.afterHelperCreated=function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitProgram_=this.helper.getProgram(this.hitFragmentShader_,this.hitVertexShader_),this.hitRenderTarget_=new b["a"](this.helper))},t.prototype.handleSourceFeatureAdded_=function(e){var t=e.feature;this.featureCache_[Object(I["c"])(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++},t.prototype.handleSourceFeatureChanged_=function(e){var t=e.feature;this.featureCache_[Object(I["c"])(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}},t.prototype.handleSourceFeatureDelete_=function(e){var t=e.feature;delete this.featureCache_[Object(I["c"])(t)],this.featureCount_--},t.prototype.handleSourceFeatureClear_=function(){this.featureCache_={},this.featureCount_=0},t.prototype.renderFrame=function(e){var t=this.helper.getGL();this.preRender(t,e);var r=e.viewState.projection,i=this.getLayer(),n=i.getSource(),a=n.getWrapX()&&r.canWrapX(),s=r.getExtent(),o=e.extent,h=a?Object(d["E"])(s):null,u=a?Math.ceil((o[2]-s[2])/h)+1:1,c=a?Math.floor((o[0]-s[0])/h):0,f=c,p=this.indicesBuffer_.getSize();do{this.helper.makeProjectionTransform(e,this.currentTransform_),Object(l["l"])(this.currentTransform_,f*h,0),Object(l["f"])(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e),this.helper.drawElements(0,p)}while(++f<u);this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);var g=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderHitDetection(e,c,u,h),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),g},t.prototype.prepareFrameInternal=function(e){var t=this.getLayer(),r=t.getSource(),n=e.viewState,s=!e.viewHints[a["a"].ANIMATING]&&!e.viewHints[a["a"].INTERACTING],o=!Object(d["o"])(this.previousExtent_,e.extent),h=this.sourceRevision_<r.getRevision();if(h&&(this.sourceRevision_=r.getRevision()),s&&(o||h)){var u=n.projection,c=n.resolution,f=t instanceof i["a"]?t.getRenderBuffer():0,l=Object(d["c"])(e.extent,f*c);r.loadFeatures(l,c,u),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()}return this.helper.useProgram(this.program_),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},t.prototype.rebuildBuffers_=function(e){var t=Object(l["c"])();this.helper.makeProjectionTransform(e,t);var r,i,n=(2+this.customAttributes.length)*this.featureCount_;if(this.renderInstructions_&&this.renderInstructions_.length===n||(this.renderInstructions_=new Float32Array(n)),this.hitDetectionEnabled_){var a=(7+this.customAttributes.length)*this.featureCount_;this.hitRenderInstructions_&&this.hitRenderInstructions_.length===a||(this.hitRenderInstructions_=new Float32Array(a))}var s,o=[],h=[],u=0,c=0;for(var f in this.featureCache_)if(r=this.featureCache_[f],i=r.geometry,i&&"Point"===i.getType()){o[0]=i.getFlatCoordinates()[0],o[1]=i.getFlatCoordinates()[1],Object(l["a"])(t,o),s=v(c+6,h),this.renderInstructions_[u++]=o[0],this.renderInstructions_[u++]=o[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[c++]=o[0],this.hitRenderInstructions_[c++]=o[1],this.hitRenderInstructions_[c++]=s[0],this.hitRenderInstructions_[c++]=s[1],this.hitRenderInstructions_[c++]=s[2],this.hitRenderInstructions_[c++]=s[3],this.hitRenderInstructions_[c++]=Number(f));for(var d=void 0,p=0;p<this.customAttributes.length;p++)d=this.customAttributes[p].callback(r.feature,r.properties),this.renderInstructions_[u++]=d,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[c++]=d)}var _={type:g.GENERATE_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(_["projectionTransform"]=t,_["generateBuffersRun"]=++this.generateBuffersRun_,this.ready=!1,this.worker_.postMessage(_,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){var m={type:g.GENERATE_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};m["projectionTransform"]=t,m["hitDetection"]=!0,this.worker_.postMessage(m,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,i,n){if(Object(x["a"])(this.hitDetectionEnabled_,66),this.hitRenderInstructions_){var a=Object(l["a"])(t.coordinateToPixelTransform,e.slice()),s=this.hitRenderTarget_.readPixel(a[0]/2,a[1]/2),o=[s[0]/255,s[1]/255,s[2]/255,s[3]/255],h=m(o),u=this.hitRenderInstructions_[h],c=Math.floor(u).toString(),f=this.getLayer().getSource(),d=f.getFeatureByUid(c);return d?i(d,this.getLayer(),null):void 0}},t.prototype.renderHitDetection=function(e,t,r,i){if(this.hitVerticesBuffer_.getSize()){var n=t;this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.useProgram(this.hitProgram_),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);do{this.helper.makeProjectionTransform(e,this.currentTransform_),Object(l["l"])(this.currentTransform_,n*i,0),Object(l["f"])(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e);var a=this.indicesBuffer_.getSize();this.helper.drawElements(0,a)}while(++n<r)}},t.prototype.disposeInternal=function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach((function(e){Object(R["c"])(e)})),this.sourceListenKeys_=null,e.prototype.disposeInternal.call(this)},t}(y);t["a"]=O}}]);
//# sourceMappingURL=chunk-b63012a2.6944f836.js.map